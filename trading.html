<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blox Fruits Trading</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
&nbsp;&nbsp;.gradient-text {@apply bg-gradient-to-r from-purple-300 to-indigo-400 bg-clip-text text-transparent;}
&nbsp;&nbsp;.bg-grid-pattern {background-image:url("data:image/svg+xml,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 10h20M10 0v20' stroke='%23ffffff' stroke-width='0.5' opacity='0.1'/%3E%3C/svg%3E");}
&nbsp;&nbsp;.scrollbar-hide {-ms-overflow-style:none;scrollbar-width:none;}
&nbsp;&nbsp;.scrollbar-hide::-webkit-scrollbar{display:none;}
&nbsp;&nbsp;.notification-badge {position:absolute;top:-6px;right:-6px;background:#ef4444;color:white;font-size:10px;font-weight:bold;min-width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center;}
&nbsp;&nbsp;.mobile-menu {transition:transform .3s ease;}
&nbsp;&nbsp;.mobile-menu.open {transform:translateX(0);}
&nbsp;&nbsp;.trade-card {transition:transform .3s ease,box-shadow .3s ease;}
&nbsp;&nbsp;.trade-card:hover {transform:translateY(-4px);box-shadow:0 20px 25px -5px rgba(139,92,246,0.2),0 10px 10px -5px rgba(0,0,0,0.3);}
&nbsp;&nbsp;.tick {position:absolute;inset:0;background:rgba(0,0,0,0.4);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s;}
&nbsp;&nbsp;.tick.show {opacity:1;}
</style>
</head>
<body class="bg-black text-white min-h-screen flex flex-col">
<!-- ==== GENDER MODAL ==== -->
<div id="genderModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/90 px-4">
&nbsp;&nbsp;<div class="relative w-full max-w-sm rounded-2xl bg-gray-800 p-8 border border-purple-500/30 shadow-2xl">
&nbsp;&nbsp;&nbsp;&nbsp;<h2 class="text-2xl font-bold text-center mb-6">Choose Your Avatar</h2>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="grid grid-cols-2 gap-6">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="selectMale" class="group flex flex-col items-center p-6 rounded-xl bg-gray-700/50 hover:bg-purple-600/30 transition border-2 border-transparent hover:border-purple-500">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://iili.io/KmAE9MF.webp" class="w-32 h-32 object-contain mb-3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-lg font-semibold">Male</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="selectFemale" class="group flex flex-col items-center p-6 rounded-xl bg-gray-700/50 hover:bg-purple-600/30 transition border-2 border-transparent hover:border-purple-500">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://iili.io/KmAEH6g.webp" class="w-32 h-32 object-contain mb-3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-lg font-semibold">Female</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</div>
</div>
<!-- ==== MOBILE TOP BAR ==== -->
<div class="lg:hidden fixed top-0 left-0 right-0 bg-gray-800/95 backdrop-blur z-50 border-b border-purple-500/20">
&nbsp;&nbsp;<div class="flex items-center justify-between p-3">
&nbsp;&nbsp;&nbsp;&nbsp;<button id="mobileMenuBtn" class="p-2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center gap-3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="mobileMsgBtn" class="relative p-2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle h-6 w-6"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="mobileMsgBadge" class="notification-badge hidden">0</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img id="mobileAvatar" class="w-8 h-8 rounded-full" src="">
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</div>
</div>
<!-- ==== MOBILE MENU ==== -->
<div id="mobileMenu" class="mobile-menu fixed inset-0 bg-gray-800/95 backdrop-blur z-40 -translate-x-full lg:hidden">
&nbsp;&nbsp;<div class="p-4 border-b border-white/10 flex justify-between items-center">
&nbsp;&nbsp;&nbsp;&nbsp;<h3 class="font-bold">Menu</h3>
&nbsp;&nbsp;&nbsp;&nbsp;<button id="closeMobileMenu" class="text-white/70 hover:text-white">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;</div>
&nbsp;&nbsp;<div class="p-4 space-y-4">
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://bloxfruittrading.com/values" class="block p-3 rounded-lg bg-gray-700/50">Values</a>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://bloxfruittrading.com/calculator" class="block p-3 rounded-lg bg-gray-700/50">Calculator</a>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://bloxfruittrading.com/rate" class="block p-3 rounded-lg bg-gray-700/50">Reviews</a>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://bloxfruittrading.com/giveaways" class="block p-3 rounded-lg bg-gray-700/50">Stocks</a>
&nbsp;&nbsp;&nbsp;&nbsp;<button id="mobileNewAccount" class="w-full p-3 rounded-lg bg-gray-700/50 text-left">New Account</button>
&nbsp;&nbsp;</div>
</div>
<!-- ==== DESKTOP TOP BAR ==== -->
<div class="hidden lg:block w-full">
&nbsp;&nbsp;<div class="relative mx-auto flex w-full justify-between px-4 py-3 transition duration-200 rounded-full bg-transparent">
&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex w-full flex-row items-center justify-between">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!-- Logo + Game Switcher -->
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex w-[90px] flex-row items-center gap-2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://bloxfruittrading.com/"><img alt="logo" loading="lazy" width="48" height="48" decoding="async" class="min-w-10 min-h-10 w-full h-full object-contain" src="./final ones_files/KL1P0ib.gif"></a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="relative z-50">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button class="group flex items-center gap-3 rounded-xl border border-border/60 bg-black/40 px-4 py-2.5 backdrop-blur-md transition-all hover:border-primary/50 hover:bg-black/60 hover:shadow-[0_0_15px_rgba(124,58,237,0.3)]">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="relative flex items-center gap-3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex flex-col items-start">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="max-w-[150px] truncate text-base font-bold text-white">Blox Fruits</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-xs text-neutral-400">Switch Game</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tabler-icon tabler-icon-chevron-down ml-1 h-4 w-4 text-neutral-400"><path d="M6 9l6 6l6 -6"></path></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!-- Nav Links -->
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<nav aria-label="Main" class="relative z-10 flex max-w-max flex-1 items-center justify-center">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<ul class="group flex-1 list-none space-x-5 flex items-center justify-center">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<li><a href="https://bloxfruittrading.com/trading" class="flex flex-col items-center gap-2 rounded-lg px-3 py-1 text-sm transition-colors hover:bg-accent"><span class="flex h-7 w-7 items-center justify-center"><img src="./final ones_files/KL12OJt.png" alt="Icon" class="h-full w-full object-contain"></span><span class="text-xs font-medium">Trading</span></a></li>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<li><a href="https://bloxfruittrading.com/values" class="flex flex-col items-center gap-2 rounded-lg px-3 py-1 text-sm transition-colors hover:bg-accent"><span class="flex h-7 w-7 items-center justify-center"><svg width="31" height="30" viewBox="0 0 31 30" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20.6875 5.625H25.375V27.1875H4.75V5.625H9.4375V7.5H20.6875V5.625ZM8.5 15H21.625V13.125H8.5V15ZM8.5 22.5H21.625V20.625H8.5V22.5ZM11.3125 5.625V2.8125H18.8125V5.625H11.3125Z" fill="currentColor"></path></svg></span><span class="text-xs font-medium">Values</span></a></li>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<li><a href="https://bloxfruittrading.com/calculator" class="flex flex-col items-center gap-2 rounded-lg px-3 py-1 text-sm transition-colors hover:bg-accent"><span class="flex h-7 w-7 items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calculator"><rect width="16" height="20" x="4" y="2" rx="2"></rect><line x1="8" x2="16" y1="6" y2="6"></line><line x1="16" x2="16" y1="14" y2="18"></line><path d="M16 10h.01"></path><path d="M12 10h.01"></path><path d="M8 10h.01"></path><path d="M12 14h.01"></path><path d="M8 14h.01"></path><path d="M12 18h.01"></path><path d="M8 18h.01"></path></svg></span><span class="text-xs font-medium">Calculator</span></a></li>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<li><a href="https://bloxfruittrading.com/rate" class="flex flex-col items-center gap-2 rounded-lg px-3 py-1 text-sm transition-colors hover:bg-accent"><span class="flex h-7 w-7 items-center justify-center text-gray-400 text-lg">Stars</span><span class="text-xs font-medium">Reviews</span></a></li>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<li><a href="https://bloxfruittrading.com/giveaways" class="flex flex-col items-center gap-2 rounded-lg px-3 py-1 text-sm transition-colors hover:bg-accent"><span class="flex h-7 w-7 items-center justify-center text-gray-400 text-lg">Chart</span><span class="text-xs font-medium">Stocks</span></a></li>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</ul>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nav>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!-- Right Icons -->
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center space-x-4">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="_blank" href="https://bloxfruittrading.com/discord" class="flex items-center justify-center rounded-full p-1.5 transition-colors hover:bg-accent/50">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="800" height="800" preserveAspectRatio="xMidYMid" viewBox="0 -28.5 256 256" class="h-6 w-6"><path fill="#5865F2" d="M216.856 16.597A208.5 208.5 0 0 0 164.042 0c-2.275 4.113-4.933 9.645-6.766 14.046q-29.538-4.442-58.533 0c-1.832-4.4-4.55-9.933-6.846-14.046a207.8 207.8 0 0 0-52.855 16.638C5.618 67.147-3.443 116.4 1.087 164.956c22.169 16.555 43.653 26.612 64.775 33.193A161 161 0 0 0 79.735 175.3a136.4 136.4 0 0 1-21.846-10.632 109 109 0 0 0 5.356-4.237c42.122 19.702 87.89 19.702 129.51 0a132 132 0 0 0 5.355 4.237 136 136 0 0 1-21.886 10.653c4.006 8.02 8.638 15.67 13.873 22.848 21.142-6.58 42.646-16.637 64.815-33.213 5.316-56.288-9.08-105.09-38.056-148.36M85.474 135.095c-12.645 0-23.015-11.805-23.015-26.18s10.149-26.2 23.015-26.2 23.236 11.804 23.015 26.2c.02 14.375-10.148 26.18-23.015 26.18m85.051 0c-12.645 0-23.014-11.805-23.014-26.18s10.148-26.2 23.014-26.2c12.867 0 23.236 11.804 23.015 26.2 0 14.375-10.148 26.18-23.015 26.18"></path></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="openMessagesBtn" class="relative flex items-center justify-center rounded-full p-1.5 transition-colors hover:bg-accent/50">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle h-6 w-6"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="msgBadge" class="notification-badge hidden">0</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div id="userInfo" class="flex items-center gap-3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img id="userAvatar" class="w-10 h-10 rounded-full" src="">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex flex-col">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="userName" class="font-semibold"></span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="newAccount" class="text-xs text-purple-400 hover:underline">New Account</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</div>
</div>
<!-- ==== MAIN CONTENT ==== -->
<main class="flex-1 pt-16 lg:pt-0 px-4 lg:px-8 max-w-7xl mx-auto w-full">
&nbsp;&nbsp;<header class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between mb-8 mt-6 lg:mt-10">
&nbsp;&nbsp;&nbsp;&nbsp;<div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<h1 class="text-3xl font-bold tracking-tight sm:text-4xl">Trade Ads</h1>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<p class="pt-2 text-sm text-gray-400 sm:text-base">Browse and find the perfect trade for your items.</p>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;<button id="createTradeBtn" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 relative overflow-hidden bg-gradient-to-br from-purple-500 via-purple-600 to-purple-700 hover:from-purple-600 hover:via-purple-700 hover:to-purple-800 hover:shadow-lg hover:shadow-purple-500/25 active:scale-[0.97] border border-purple-500/20 ring-1 ring-white/10 h-10 px-4 py-2 w-full sm:w-auto text-white transition-all duration-300">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus mr-2 h-5 w-5"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-medium">Create Trade Ad</span>
&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;</header>
&nbsp;&nbsp;<nav aria-label="Trade filters" class="my-5">
&nbsp;&nbsp;&nbsp;&nbsp;<div class="grid gap-4 rounded-xl bg-white/5 p-4 border border-purple-500/10">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="space-y-2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="flex items-center gap-2 text-sm font-medium">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search h-4 w-4 text-gray-400"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search Items
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex flex-col gap-3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="relative flex-1">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="searchFilter" class="flex h-10 w-full border-0 bg-gray-800/50 pl-4 pr-10 rounded-lg text-base placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-purple-500 transition-colors" placeholder="Search items by name..." value="">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="clearSearch" class="absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-white">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center gap-2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-xs font-medium text-gray-400">Search in:</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex rounded-lg bg-gray-800/50 p-1">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="filterAll" class="px-3 py-1.5 text-xs font-medium transition-all duration-200 rounded-md bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-sm">All</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="filterOffering" class="px-3 py-1.5 text-xs font-medium transition-all duration-200 rounded-md text-gray-400 hover:text-white hover:bg-gray-700/50">Offering</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="filterRequesting" class="px-3 py-1.5 text-xs font-medium transition-all duration-200 rounded-md text-gray-400 hover:text-white hover:bg-gray-700/50">Requesting</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</nav>
&nbsp;&nbsp;<div id="trades" class="grid gap-6 lg:gap-8"></div>
</main>
<!-- ==== MESSAGING PANEL ==== -->
<div id="messagingPanel" class="hidden fixed inset-0 lg:right-0 lg:left-auto lg:top-0 lg:h-full lg:w-96 bg-gray-800 border-l lg:border-purple-500/30 shadow-2xl flex flex-col z-40">
&nbsp;&nbsp;<div class="p-4 border-b border-white/10 flex items-center justify-between">
&nbsp;&nbsp;&nbsp;&nbsp;<h3 class="font-bold text-lg">Messages</h3>
&nbsp;&nbsp;&nbsp;&nbsp;<button id="closeChat" class="text-white/70 hover:text-white">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;</div>
&nbsp;&nbsp;<div id="conversations" class="flex-1 overflow-y-auto p-2"></div>
&nbsp;&nbsp;<div id="chatArea" class="hidden flex-1 flex flex-col">
&nbsp;&nbsp;&nbsp;&nbsp;<div class="p-3 border-b border-white/10 flex items-center gap-3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img id="chatAvatar" class="w-10 h-10 rounded-full" src="">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div><div id="chatUser" class="font-semibold"></div><div class="text-xs text-gray-400">Trading with you</div></div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;<div id="messages" class="flex-1 overflow-y-auto p-4 space-y-3"></div>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="p-3 border-t border-white/10 flex gap-2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="msgInput" type="text" placeholder="Type a message..." class="flex-1 bg-gray-700 rounded-lg px-4 py-2 outline-none focus:border-purple-500 border border-transparent">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="sendMsg" class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg font-medium">Send</button>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</div>
</div>
<!-- ==== TRADE MODAL ==== -->
<div id="tradeModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4 overflow-y-auto">
&nbsp;&nbsp;<div class="relative w-full max-w-4xl my-8 rounded-xl bg-gray-900 border border-purple-500/20 shadow-2xl">
&nbsp;&nbsp;&nbsp;&nbsp;<button id="closeModal" class="absolute top-4 right-4 text-white/70 hover:text-white z-10">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
&nbsp;&nbsp;&nbsp;&nbsp;</button>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="p-6 pb-4 border-b border-white/10">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<h2 class="text-xl lg:text-2xl font-bold flex items-center gap-2"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg> Create Trade</h2>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<p class="text-sm text-gray-400 mt-1">Select items you're offering and requesting</p>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex gap-2 lg:gap-3 p-4 border-b border-white/10">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="offeringTab" class="px-5 py-2.5 lg:px-6 lg:py-3 rounded-full bg-purple-600 font-semibold text-sm transition">Offering</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="requestingTab" class="px-5 py-2.5 lg:px-6 lg:py-3 rounded-full bg-gray-700 font-semibold text-sm transition">Requesting</button>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="p-4"><input id="modalSearch" type="text" placeholder="Search fruits..." class="w-full px-4 py-3 bg-gray-800 rounded-lg border border-white/20 focus:border-purple-500 outline-none"></div>
&nbsp;&nbsp;&nbsp;&nbsp;<div id="itemGrid" class="grid grid-cols-3 sm:grid-cols-4 gap-3 lg:gap-4 p-4 lg:p-6 max-h-96 overflow-y-auto"></div>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex justify-end gap-3 p-4 lg:p-6 border-t border-white/10">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="cancelPost" class="px-5 py-2.5 lg:px-6 lg:py-3 bg-gray-700 rounded-lg font-medium">Cancel</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="confirmPost" class="px-5 py-2.5 lg:px-6 lg:py-3 bg-purple-600 rounded-lg font-medium hover:bg-purple-700 disabled:opacity-50" disabled>Post Trade</button>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</div>
</div>
<!-- ==== FOOTER ==== -->
<footer class="border-t border-white/10 px-4 lg:px-8 py-10 lg:py-20 bg-black/50 w-full text-xs lg:text-sm mt-16">
&nbsp;&nbsp;<div class="max-w-7xl mx-auto text-gray-500 text-center">
&nbsp;&nbsp;&nbsp;&nbsp;© 2025 Blox Fruit Trading. All rights reserved.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-gray-600">https://bloxfruittrading.com is a 3rd party website not affiliated with Blox Fruits.</span>
&nbsp;&nbsp;</div>
</footer>
<script>
const API = "https://dropjetic.pythonanywhere.com/trades";
const MSG_API = "https://dropjetic.pythonanywhere.com/messages";
/* ==== REAL FRUITS FROM FIRST SITE ==== */
const fruits = {
&nbsp;&nbsp;"West Dragon":{beli:"15M",demand:"10/10",image:"https://i.postimg.cc/7LfBxxs8/West-Dragon.png"},
&nbsp;&nbsp;"East Dragon":{beli:"15M",demand:"10/10",image:"https://i.postimg.cc/gkzHzzjS/East-Dragon.png"},
&nbsp;&nbsp;"Kitsune":{beli:"8M",demand:"10/10",image:"https://i.postimg.cc/CLxbycr9/Kitsune.png"},
&nbsp;&nbsp;"Yeti":{beli:"5M",demand:"10/10",image:"https://i.postimg.cc/mrJmk0Jc/Yeti.png"},
&nbsp;&nbsp;"Gas":{beli:"3.2M",demand:"8/10",image:"https://i.postimg.cc/nzKqxgJf/Gas.png"},
&nbsp;&nbsp;"Leopard":{beli:"5M",demand:"10/10",image:"https://i.postimg.cc/rwdWsKkJ/Leopard.png"},
&nbsp;&nbsp;"Lightning":{beli:"2.1M",demand:"6/10",image:"https://i.postimg.cc/MHTHLFZD/Rumble.png"},
&nbsp;&nbsp;"Dough":{beli:"2.8M",demand:"10/10",image:"https://i.postimg.cc/wxckYyqR/Dough.png"},
&nbsp;&nbsp;"Pain":{beli:"2.3M",demand:"6/10",image:"https://i.postimg.cc/mk21srj7/Pain.png"},
&nbsp;&nbsp;"T-Rex":{beli:"2.7M",demand:"8/10",image:"https://i.postimg.cc/zGDtcwTf/T-Rex.png"},
&nbsp;&nbsp;"Gravity":{beli:"2.5M",demand:"4/10",image:"https://i.postimg.cc/D02Lw6vJ/Gravity.png"},
&nbsp;&nbsp;"Mammoth":{beli:"2.7M",demand:"5/10",image:"https://i.postimg.cc/sXJGqWYV/Mammoth.png"},
&nbsp;&nbsp;"Spirit":{beli:"3.4M",demand:"6/10",image:"https://i.postimg.cc/wTpbhYvL/Spirit.png"},
&nbsp;&nbsp;"Control":{beli:"3.2M",demand:"5/10",image:"https://i.postimg.cc/9QNpg6Wx/Control.png"},
&nbsp;&nbsp;"Venom":{beli:"3M",demand:"6/10",image:"https://i.postimg.cc/zGdtZLkF/Venom.png"},
&nbsp;&nbsp;"Shadow":{beli:"2.9M",demand:"5/10",image:"https://i.postimg.cc/kGpGPvBd/Shadow.png"},
&nbsp;&nbsp;"Portal":{beli:"1.9M",demand:"10/10",image:"https://i.postimg.cc/DzkWz65v/Portal.png"},
&nbsp;&nbsp;"Buddha":{beli:"1.2M",demand:"10/10",image:"https://i.postimg.cc/02nZD6h1/Buddha.png"},
&nbsp;&nbsp;"Blizzard":{beli:"2.4M",demand:"5/10",image:"https://i.postimg.cc/fTDBV72v/Blizzard.png"},
&nbsp;&nbsp;"Creation":{beli:"1.4M",demand:"3/10",image:"https://i.postimg.cc/HLctq6nT/Creation.png"}
};
/* ==== STATE ==== */
let currentUser = null;
let trades = [];
let messages = {};
let unreadCounts = {};
let currentChatPartner = null;
let filterMode = 'all';
let searchTerm = '';
let currentSide = 'offering';
let selectedOffering = new Set();
let selectedWanting = new Set();
/* ==== DOM ELEMENTS ==== */
const genderModal = document.getElementById('genderModal');
const selectMale = document.getElementById('selectMale');
const selectFemale = document.getElementById('selectFemale');
const tradeModal = document.getElementById('tradeModal');
const createTradeBtn = document.getElementById('createTradeBtn');
const searchFilter = document.getElementById('searchFilter');
const clearSearch = document.getElementById('clearSearch');
const filterAll = document.getElementById('filterAll');
const filterOffering = document.getElementById('filterOffering');
const filterRequesting = document.getElementById('filterRequesting');
const messagingPanel = document.getElementById('messagingPanel');
const conversationsDiv = document.getElementById('conversations');
const chatArea = document.getElementById('chatArea');
const messagesDiv = document.getElementById('messages');
const msgInput = document.getElementById('msgInput');
const sendMsgBtn = document.getElementById('sendMsg');
const openMessagesBtn = document.getElementById('openMessagesBtn');
const mobileMsgBtn = document.getElementById('mobileMsgBtn');
const closeChatBtn = document.getElementById('closeChat');
const offeringTab = document.getElementById('offeringTab');
const requestingTab = document.getElementById('requestingTab');
const modalSearch = document.getElementById('modalSearch');
const itemGrid = document.getElementById('itemGrid');
const confirmPost = document.getElementById('confirmPost');
const cancelPost = document.getElementById('cancelPost');
const closeModal = document.getElementById('closeModal');
/* ==== USER / GENDER ==== */
function generateUser(gender){
&nbsp;&nbsp;const id = Date.now().toString(36)+Math.random().toString(36).substr(2);
&nbsp;&nbsp;const username = "User_"+Math.random().toString(36).substr(2,5);
&nbsp;&nbsp;const avatar = gender==="male"?"https://iili.io/KmAE9MF.webp":"https://iili.io/KmAEH6g.webp";
&nbsp;&nbsp;return {id,username,avatar,gender};
}
function loadUser(){
&nbsp;&nbsp;const saved = localStorage.getItem('bf_user');
&nbsp;&nbsp;if(saved){
&nbsp;&nbsp;&nbsp;&nbsp;const u = JSON.parse(saved);
&nbsp;&nbsp;&nbsp;&nbsp;if(u.gender){ currentUser=u; updateUserUI(); return true; }
&nbsp;&nbsp;&nbsp;&nbsp;else localStorage.removeItem('bf_user');
&nbsp;&nbsp;}
&nbsp;&nbsp;return false;
}
function showGenderModal(){ genderModal.classList.remove('hidden'); document.body.style.overflow='hidden'; }
function hideGenderModal(){ genderModal.classList.add('hidden'); document.body.style.overflow=''; }
function finalizeUser(gender){
&nbsp;&nbsp;currentUser = generateUser(gender);
&nbsp;&nbsp;localStorage.setItem('bf_user',JSON.stringify(currentUser));
&nbsp;&nbsp;updateUserUI(); hideGenderModal(); loadTrades(); loadMessages();
}
selectMale.onclick = ()=>finalizeUser('male');
selectFemale.onclick = ()=>finalizeUser('female');
function updateUserUI(){
&nbsp;&nbsp;document.getElementById('userAvatar')?.setAttribute('src',currentUser.avatar);
&nbsp;&nbsp;document.getElementById('mobileAvatar').src = currentUser.avatar;
&nbsp;&nbsp;document.getElementById('userName') && (document.getElementById('userName').textContent = currentUser.username);
}
/* ==== NEW ACCOUNT ==== */
document.getElementById('newAccount')?.addEventListener('click',()=>{ if(confirm('Create new account?')){ localStorage.removeItem('bf_user'); currentUser=null; showGenderModal(); } });
document.getElementById('mobileNewAccount')?.addEventListener('click',()=>{ if(confirm('Create new account?')){ localStorage.removeItem('bf_user'); currentUser=null; showGenderModal(); } });
/* ==== ITEM CARD (EXACT FROM FIRST SITE) ==== */
function itemHTMLCard(i,color="pink"){
&nbsp;&nbsp;const grad = color==="rose"?"from-rose-400/50 to-rose-600/40":"from-pink-400/50 to-pink-600/40";
&nbsp;&nbsp;return `<div class="group relative rounded-md border bg-gradient-to-br transition-transform hover:-translate-y-1 hover:z-10 ${grad} p-0.5 border-purple-500/20 h-[100px] w-[75px] sm:h-[120px] sm:w-[90px] lg:h-[150px] lg:w-[120px] shrink-0">
&nbsp;&nbsp;&nbsp;&nbsp;<div class="bg-grid-pattern absolute inset-0 opacity-10"></div>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="relative z-10 flex h-full w-full flex-col">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="relative flex flex-1 items-center justify-center p-0.5">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="$$ {i.image}" alt=" $${i.name}" class="h-auto max-h-full w-auto max-w-full object-contain drop-shadow-md">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="absolute left-1 top-1"><span class="rounded-md px-1.5 py-0.5 text-[9px] lg:text-[10px] font-bold uppercase bg-purple-600/80 text-white">R</span></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex flex-col items-center gap-0.5 pb-1">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="bg-black/80 backdrop-blur-md rounded-md border border-white/20 p-1">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center gap-1 lg:gap-2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center gap-1"><svg class="h-2.5 w-2.5 lg:h-3 lg:w-3 text-amber-400" viewBox="0 0 512 512" fill="currentColor"><path d="M416 64H257.6L76.5 251.6c-8 8-12.3 18.5-12.5 29-.3 11.3 3.9 22.6 12.5 31.2l123.7 123.6c8 8 20.8 12.5 28.8 12.5s22.8-3.9 31.4-12.5L448 256V96l-32-32zm-30.7 102.7c-21.7 6.1-41.3-10-41.3-30.7 0-17.7 14.3-32 32-32 20.7 0 36.8 19.6 30.7 41.3-2.9 10.3-11.1 18.5-21.4 21.4z"></path></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-[10px] lg:text-xs font-bold text-amber-300">${i.beli}</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center gap-1"><svg class="lucide lucide-trending-up h-2.5 w-2.5 lg:h-3 lg:w-3 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline><polyline points="16 7 22 7 22 13"></polyline></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-[10px] lg:text-xs font-bold text-white">${i.demand}</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="absolute inset-x-0 bottom-0.5 flex justify-center"><span class="rounded-full bg-pink-400 h-1.5 w-1.5"></span></div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</div>`;
}
/* ==== TRADE CARD (EXACT FROM FIRST SITE) ==== */
function renderTrade(t){
&nbsp;&nbsp;const totalItems = t.offering.length + t.wanting.length;
&nbsp;&nbsp;const scrollClass = totalItems > 8 ? 'max-h-32 lg:max-h-40 overflow-y-auto' : '';
&nbsp;&nbsp;const offerHTML = t.offering.map(i => itemHTMLCard(i,"pink")).join('');
&nbsp;&nbsp;const wantHTML = t.wanting.map(i => itemHTMLCard(i,"rose")).join('');
&nbsp;&nbsp;const isOwner = t.user.id === currentUser?.id;
&nbsp;&nbsp;const deleteBtn = isOwner ? `<button onclick="deleteTrade(${t.id})" class="ml-2 p-1.5 bg-red-600/80 hover:bg-red-700 rounded-full"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>` : '';
&nbsp;&nbsp;return `<div class="bg-gray-800/50 rounded-xl p-3 lg:p-4 border border-purple-500/20 trade-card">
&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center gap-2 lg:gap-3 mb-2 lg:mb-3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="${t.user.avatar}" class="w-8 h-8 lg:w-10 lg:h-10 rounded-full">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex-1">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="font-semibold text-sm lg:text-base">${t.user.username}</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="text-xs text-gray-400">Posted just now</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${isOwner ? '<span class="text-xs text-purple-400 mr-2">Your trade</span>' : ''}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button class="bg-purple-600 hover:bg-purple-700 px-3 py-1 lg:px-4 lg:py-1.5 rounded-full text-xs lg:text-sm font-medium" onclick="openChat('${t.user.id}')">Message</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${deleteBtn}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex flex-row items-center space-x-1 space-y-0 sm:space-y-1.5 ${scrollClass}">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex-1 rounded-lg border border-purple-500/10 bg-background/30 p-1 lg:p-1.5">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<h3 class="mb-1 text-xs lg:mb-1.5 lg:text-sm font-medium text-purple-300 flex items-center gap-1"><span class="gradient-text">Offering</span></h3>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="scrollbar-hide flex space-x-1 lg:space-x-1.5 overflow-x-auto pt-1">${offerHTML}</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex items-center justify-center">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex h-6 w-6 lg:h-8 lg:w-8 items-center justify-center rounded-full bg-purple-500/20 border border-purple-500/30">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg class="lucide lucide-arrow-right h-3 w-3 lg:h-4 lg:w-4 text-purple-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex-1 rounded-lg border border-purple-500/10 bg-background/30 p-1 lg:p-1.5">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<h3 class="mb-1 text-xs lg:mb-1.5 lg:text-sm font-medium text-purple-300 flex items-center gap-1"><span class="gradient-text">Requesting</span></h3>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="scrollbar-hide flex space-x-1 lg:space-x-1.5 overflow-x-auto pt-1">${wantHTML}</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</div>`;
}
/* ==== LOAD TRADES ==== */
async function loadTrades(){
&nbsp;&nbsp;try{
&nbsp;&nbsp;&nbsp;&nbsp;const res = await fetch(API);
&nbsp;&nbsp;&nbsp;&nbsp;trades = await res.json();
&nbsp;&nbsp;&nbsp;&nbsp;filterAndRender();
&nbsp;&nbsp;}catch(e){
&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("trades").innerHTML = `<p class="text-center text-red-400">Failed to load trades.</p>`;
&nbsp;&nbsp;}
}
/* ==== FILTER & SEARCH ==== */
function filterAndRender(){
&nbsp;&nbsp;let filtered = trades;
&nbsp;&nbsp;if(searchTerm){
&nbsp;&nbsp;&nbsp;&nbsp;filtered = filtered.filter(t=>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.offering.some(i=>i.name.toLowerCase().includes(searchTerm)) ||
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.wanting.some(i=>i.name.toLowerCase().includes(searchTerm))
&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;}
&nbsp;&nbsp;if(filterMode==='offering') filtered = filtered.filter(t=>t.offering.length>0);
&nbsp;&nbsp;if(filterMode==='requesting') filtered = filtered.filter(t=>t.wanting.length>0);
&nbsp;&nbsp;document.getElementById("trades").innerHTML = filtered.length
&nbsp;&nbsp;&nbsp;&nbsp;? filtered.map(renderTrade).join("")
&nbsp;&nbsp;&nbsp;&nbsp;: `<p class="text-center text-gray-500 col-span-full">No trades found.</p>`;
}
searchFilter.oninput = e=>{ searchTerm=e.target.value.toLowerCase(); filterAndRender(); };
clearSearch.onclick = ()=>{ searchFilter.value=''; searchTerm=''; filterAndRender(); };
filterAll.onclick = ()=>{ filterMode='all'; updateFilterButtons(); filterAndRender(); };
filterOffering.onclick = ()=>{ filterMode='offering'; updateFilterButtons(); filterAndRender(); };
filterRequesting.onclick = ()=>{ filterMode='requesting'; updateFilterButtons(); filterAndRender(); };
function updateFilterButtons(){
&nbsp;&nbsp;filterAll.classList.toggle('bg-gradient-to-r',filterMode==='all');
&nbsp;&nbsp;filterAll.classList.toggle('from-purple-500',filterMode==='all');
&nbsp;&nbsp;filterAll.classList.toggle('to-purple-600',filterMode==='all');
&nbsp;&nbsp;filterAll.classList.toggle('text-white',filterMode==='all');
&nbsp;&nbsp;[filterOffering,filterRequesting].forEach(b=>{ b.classList.remove('bg-gradient-to-r','from-purple-500','to-purple-600','text-white'); b.classList.add('text-gray-400','hover:text-white'); });
&nbsp;&nbsp;if(filterMode==='offering') filterOffering.classList.add('bg-gradient-to-r','from-purple-500','to-purple-600','text-white');
&nbsp;&nbsp;if(filterMode==='requesting') filterRequesting.classList.add('bg-gradient-to-r','from-purple-500','to-purple-600','text-white');
}
/* ==== MODAL ITEM GRID (WITH TICK) ==== */
function renderModalItems(){
&nbsp;&nbsp;const term = modalSearch.value.toLowerCase();
&nbsp;&nbsp;const filtered = Object.entries(fruits).filter(([name])=>name.toLowerCase().includes(term));
&nbsp;&nbsp;itemGrid.innerHTML = filtered.map(([name,data])=>{
&nbsp;&nbsp;&nbsp;&nbsp;const selected = currentSide==='offering' ? selectedOffering.has(name) : selectedWanting.has(name);
&nbsp;&nbsp;&nbsp;&nbsp;return `<button data-name="${name}" class="relative group flex flex-col items-center p-2 lg:p-3 rounded-xl bg-gray-800/50 border border-white/10 hover:border-purple-500/50 transition">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="relative">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="${data.image}" class="w-16 h-16 lg:w-20 lg:h-20 object-contain">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="tick ${selected?'show':''}">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<svg class="w-12 h-12 lg:w-16 lg:h-16 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M5 13l4 4L19 7"/></svg>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="mt-1 lg:mt-2 text-xs font-medium truncate w-full text-center">${name}</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-[9px] lg:text-[10px] text-gray-400">${data.beli} • ${data.demand}</span>
&nbsp;&nbsp;&nbsp;&nbsp;</button>`;
&nbsp;&nbsp;}).join('');
}
itemGrid.addEventListener('click', e=>{
&nbsp;&nbsp;const btn = e.target.closest('button[data-name]');
&nbsp;&nbsp;if(btn){
&nbsp;&nbsp;&nbsp;&nbsp;const name = btn.dataset.name;
&nbsp;&nbsp;&nbsp;&nbsp;const set = currentSide==='offering'?selectedOffering:selectedWanting;
&nbsp;&nbsp;&nbsp;&nbsp;set.has(name)?set.delete(name):set.add(name);
&nbsp;&nbsp;&nbsp;&nbsp;renderModalItems();
&nbsp;&nbsp;&nbsp;&nbsp;confirmPost.disabled = selectedOffering.size===0 || selectedWanting.size===0;
&nbsp;&nbsp;}
});
/* ==== CREATE TRADE MODAL ==== */
createTradeBtn.onclick = ()=>{ if(!currentUser?.gender) return; openTradeModal(); };
function openTradeModal(){
&nbsp;&nbsp;selectedOffering.clear(); selectedWanting.clear(); currentSide='offering';
&nbsp;&nbsp;offeringTab.classList.replace('bg-gray-700','bg-purple-600');
&nbsp;&nbsp;requestingTab.classList.replace('bg-purple-600','bg-gray-700');
&nbsp;&nbsp;modalSearch.value=''; renderModalItems();
&nbsp;&nbsp;tradeModal.classList.remove('hidden');
}
closeModal.onclick = cancelPost.onclick = ()=>{ tradeModal.classList.add('hidden'); };
offeringTab.onclick = ()=>{ currentSide='offering'; offeringTab.classList.replace('bg-gray-700','bg-purple-600'); requestingTab.classList.replace('bg-purple-600','bg-gray-700'); renderModalItems(); };
requestingTab.onclick = ()=>{ currentSide='requesting'; requestingTab.classList.replace('bg-gray-700','bg-purple-600'); offeringTab.classList.replace('bg-purple-600','bg-gray-700'); renderModalItems(); };
modalSearch.oninput = renderModalItems;
confirmPost.onclick = async ()=>{
&nbsp;&nbsp;if(selectedOffering.size===0 || selectedWanting.size===0) return;
&nbsp;&nbsp;const offering = Array.from(selectedOffering).map(name=>({name,img:fruits[name].image,beli:fruits[name].beli,demand:fruits[name].demand}));
&nbsp;&nbsp;const wanting = Array.from(selectedWanting).map(name=>({name,img:fruits[name].image,beli:fruits[name].beli,demand:fruits[name].demand}));
&nbsp;&nbsp;const trade = {
&nbsp;&nbsp;&nbsp;&nbsp;id:Date.now(), user:currentUser, offering, wanting,
&nbsp;&nbsp;&nbsp;&nbsp;offerValue:offering.reduce((a,i)=>a+(parseFloat(i.beli)||0),0)+"M",
&nbsp;&nbsp;&nbsp;&nbsp;wantValue:wanting.reduce((a,i)=>a+(parseFloat(i.beli)||0),0)+"M"
&nbsp;&nbsp;};
&nbsp;&nbsp;try{
&nbsp;&nbsp;&nbsp;&nbsp;await fetch(API,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(trade)});
&nbsp;&nbsp;&nbsp;&nbsp;tradeModal.classList.add('hidden');
&nbsp;&nbsp;&nbsp;&nbsp;loadTrades();
&nbsp;&nbsp;}catch{ alert("Failed to post trade."); }
};
/* ==== CHAT ==== */
function openChat(partnerId){
&nbsp;&nbsp;currentChatPartner = partnerId;
&nbsp;&nbsp;const trade = trades.find(t=>t.user.id===partnerId);
&nbsp;&nbsp;document.getElementById('chatAvatar').src = trade?.user.avatar || '';
&nbsp;&nbsp;document.getElementById('chatUser').textContent = trade?.user.username || 'User';
&nbsp;&nbsp;renderConversationList(); renderMessages();
&nbsp;&nbsp;chatArea.classList.remove('hidden'); conversationsDiv.classList.add('hidden');
&nbsp;&nbsp;messagingPanel.classList.remove('hidden');
&nbsp;&nbsp;unreadCounts[partnerId] = 0; updateBadges();
}
function closeChat(){ messagingPanel.classList.add('hidden'); currentChatPartner = null; }
openMessagesBtn.onclick = mobileMsgBtn.onclick = ()=>{ if(!currentUser?.gender) return; messagingPanel.classList.remove('hidden'); renderConversationList(); };
closeChatBtn.onclick = closeChat;
function renderConversationList(){
&nbsp;&nbsp;const partners = [...new Set(trades.map(t=>t.user.id).filter(id=>id!==currentUser?.id))];
&nbsp;&nbsp;conversationsDiv.innerHTML = partners.map(id=>{
&nbsp;&nbsp;&nbsp;&nbsp;const user = trades.find(t=>t.user.id===id).user;
&nbsp;&nbsp;&nbsp;&nbsp;const last = messages[id]?.[messages[id].length-1];
&nbsp;&nbsp;&nbsp;&nbsp;const unread = unreadCounts[id]||0;
&nbsp;&nbsp;&nbsp;&nbsp;return `<div onclick="openChat('${id}')" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-700 cursor-pointer">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="${user.avatar}" class="w-10 h-10 rounded-full">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="flex-1">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="font-medium">${user.username}</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="text-xs text-gray-400 truncate">${last?last.msg:'Start chatting'}</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${unread?`<span class="notification-badge">${unread}</span>`:''}
&nbsp;&nbsp;&nbsp;&nbsp;</div>`;
&nbsp;&nbsp;}).join('') || '<p class="text-center text-gray-500 p-4">No conversations yet.</p>';
}
function renderMessages(){
&nbsp;&nbsp;const msgs = messages[currentChatPartner]||[];
&nbsp;&nbsp;messagesDiv.innerHTML = msgs.map(m=>`
&nbsp;&nbsp;&nbsp;&nbsp;<div class="${m.from===currentUser.id?'ml-auto bg-purple-600 text-white':'bg-gray-700 text-gray-200'} max-w-[75%] rounded-lg p-2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="text-xs">${m.msg}</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="text-[10px] opacity-70">${new Date(m.time).toLocaleTimeString()}</div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>`).join('');
&nbsp;&nbsp;messagesDiv.scrollTop = messagesDiv.scrollHeight;
}
sendMsgBtn.onclick = async ()=>{
&nbsp;&nbsp;if(!msgInput.value.trim() || !currentChatPartner) return;
&nbsp;&nbsp;const txt = msgInput.value.trim(); msgInput.value = '';
&nbsp;&nbsp;const payload = {from:currentUser.id,to:currentChatPartner,msg:txt,time:Date.now()};
&nbsp;&nbsp;try{ await fetch(MSG_API,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)}); }
&nbsp;&nbsp;catch(e){ console.error(e); }
&nbsp;&nbsp;if(!messages[currentChatPartner]) messages[currentChatPartner]=[];
&nbsp;&nbsp;messages[currentChatPartner].push({...payload,from:currentUser.id});
&nbsp;&nbsp;renderMessages();
};
async function loadMessages(){
&nbsp;&nbsp;try{
&nbsp;&nbsp;&nbsp;&nbsp;const res = await fetch(MSG_API);
&nbsp;&nbsp;&nbsp;&nbsp;const all = await res.json();
&nbsp;&nbsp;&nbsp;&nbsp;messages = {}; unreadCounts = {};
&nbsp;&nbsp;&nbsp;&nbsp;all.forEach(m=>{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const partner = m.from===currentUser.id?m.to:m.from;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!messages[partner]) messages[partner]=[];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messages[partner].push(m);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(m.from!==currentUser.id) unreadCounts[partner] = (unreadCounts[partner]||0)+1;
&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;&nbsp;&nbsp;updateBadges();
&nbsp;&nbsp;}catch(e){ console.error(e); }
}
function updateBadges(){
&nbsp;&nbsp;const total = Object.values(unreadCounts).reduce((a,b)=>a+b,0);
&nbsp;&nbsp;document.getElementById('msgBadge').textContent = total;
&nbsp;&nbsp;document.getElementById('msgBadge').classList.toggle('hidden',!total);
&nbsp;&nbsp;document.getElementById('mobileMsgBadge').textContent = total;
&nbsp;&nbsp;document.getElementById('mobileMsgBadge').classList.toggle('hidden',!total);
}
/* ==== DELETE TRADE ==== */
window.deleteTrade = async (id)=>{
&nbsp;&nbsp;if(!confirm('Delete this trade?')) return;
&nbsp;&nbsp;try{
&nbsp;&nbsp;&nbsp;&nbsp;await fetch(`${API}/${id}`,{method:'DELETE'});
&nbsp;&nbsp;&nbsp;&nbsp;trades = trades.filter(t=>t.id!==id);
&nbsp;&nbsp;&nbsp;&nbsp;filterAndRender();
&nbsp;&nbsp;}catch(e){ alert('Failed to delete'); }
};
/* ==== MOBILE MENU ==== */
document.getElementById('mobileMenuBtn').onclick = ()=>{ document.getElementById('mobileMenu').classList.add('open'); };
document.getElementById('closeMobileMenu').onclick = ()=>{ document.getElementById('mobileMenu').classList.remove('open'); };
/* ==== INIT ==== */
if(!loadUser()) showGenderModal();
else{ loadTrades(); loadMessages(); setInterval(()=>{loadTrades();loadMessages();},15000); }
renderModalItems();
</script>
</body>
</html>
