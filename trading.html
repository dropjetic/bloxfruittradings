<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trade Board</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
.gradient-text {@apply bg-gradient-to-r from-purple-300 to-indigo-400 bg-clip-text text-transparent;}
.bg-grid-pattern {background-image:url("data:image/svg+xml,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 10h20M10 0v20' stroke='%23ffffff' stroke-width='0.5' opacity='0.1'/%3E%3C/svg%3E");}
.scrollbar-hide {-ms-overflow-style:none;scrollbar-width:none;}
.scrollbar-hide::-webkit-scrollbar{display:none;}
.tick {position:absolute;inset:0;background:rgba(0,0,0,0.4);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s;}
.tick.show {opacity:1;}
</style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-8">
<button id="postBtn" class="fixed bottom-8 right-8 z-50 px-6 py-4 bg-purple-600 rounded-full font-bold text-lg shadow-2xl hover:bg-purple-700">+ Post Trade</button>
<div id="trades" class="space-y-6 max-w-5xl mx-auto"></div>
<div id="tradeModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4 overflow-y-auto">
  <div class="relative w-full max-w-4xl my-8 rounded-xl bg-gray-900 border border-purple-500/20 shadow-2xl">
    <button id="closeModal" class="absolute top-4 right-4 text-white/70 hover:text-white z-10">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
    </button>
    <div class="p-6 pb-4 border-b border-white/10">
      <h2 class="text-2xl font-bold flex items-center gap-2"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg> Create Trade</h2>
      <p class="text-sm text-gray-400 mt-1">Select items you're offering and requesting</p>
    </div>
    <div class="flex gap-3 p-4 border-b border-white/10">
      <button id="offeringTab" class="px-6 py-3 rounded-full bg-purple-600 font-semibold text-sm transition">Offering</button>
      <button id="requestingTab" class="px-6 py-3 rounded-full bg-gray-700 font-semibold text-sm transition">Requesting</button>
    </div>
    <div class="p-4">
      <input id="searchInput" type="text" placeholder="Search fruits..." class="w-full px-4 py-3 bg-gray-800 rounded-lg border border-white/20 focus:border-purple-500 outline-none">
    </div>
    <div id="itemGrid" class="grid grid-cols-2 sm:grid-cols-4 gap-4 p-6 max-h-96 overflow-y-auto"></div>
    <div class="flex justify-end gap-3 p-6 border-t border-white/10">
      <button id="cancelPost" class="px-6 py-3 bg-gray-700 rounded-lg font-medium">Cancel</button>
      <button id="confirmPost" class="px-6 py-3 bg-purple-600 rounded-lg font-medium hover:bg-purple-700">Post Trade</button>
    </div>
  </div>
</div>
<script>
const API="https://dropjetic.pythonanywhere.com/trades";
const fruits={"West Dragon":{value:1500000000,beli:"15M",demand:"10/10",image:"https://i.postimg.cc/7LfBxxs8/West-Dragon.png"},"East Dragon":{value:1200000000,beli:"15M",demand:"10/10",image:"https://i.postimg.cc/gkzHzzjS/East-Dragon.png"},"Kitsune":{value:300000000,beli:"8M",demand:"10/10",image:"https://i.postimg.cc/CLxbycr9/Kitsune.png"},"Yeti":{value:150000000,beli:"5M",demand:"10/10",image:"https://i.postimg.cc/mrJmk0Jc/Yeti.png"},"Gas":{value:65000000,beli:"3.2M",demand:"8/10",image:"https://i.postimg.cc/nzKqxgJf/Gas.png"},"Leopard":{value:150000000,beli:"5M",demand:"10/10",image:"https://i.postimg.cc/rwdWsKkJ/Leopard.png"},"Lightning":{value:30000000,beli:"2.1M",demand:"6/10",image:"https://i.postimg.cc/MHTHLFZD/Rumble.png"},"Dough":{value:30000000,beli:"2.8M",demand:"10/10",image:"https://i.postimg.cc/wxckYyqR/Dough.png"},"Pain":{value:15000000,beli:"2.3M",demand:"6/10",image:"https://i.postimg.cc/mk21srj7/Pain.png"},"T-Rex":{value:20000000,beli:"2.7M",demand:"8/10",image:"https://i.postimg.cc/zGDtcwTf/T-Rex.png"},"Gravity":{value:15000000,beli:"2.5M",demand:"4/10",image:"https://i.postimg.cc/D02Lw6vJ/Gravity.png"},"Mammoth":{value:10000000,beli:"2.7M",demand:"5/10",image:"https://i.postimg.cc/sXJGqWYV/Mammoth.png"},"Spirit":{value:10000000,beli:"3.4M",demand:"6/10",image:"https://i.postimg.cc/wTpbhYvL/Spirit.png"},"Control":{value:10000000,beli:"3.2M",demand:"5/10",image:"https://i.postimg.cc/9QNpg6Wx/Control.png"},"Venom":{value:10000000,beli:"3M",demand:"6/10",image:"https://i.postimg.cc/zGdtZLkF/Venom.png"},"Shadow":{value:6500000,beli:"2.9M",demand:"5/10",image:"https://i.postimg.cc/kGpGPvBd/Shadow.png"},"Portal":{value:10000000,beli:"1.9M",demand:"10/10",image:"https://i.postimg.cc/DzkWz65v/Portal.png"},"Buddha":{value:10000000,beli:"1.2M",demand:"10/10",image:"https://i.postimg.cc/02nZD6h1/Buddha.png"},"Blizzard":{value:5000000,beli:"2.4M",demand:"5/10",image:"https://i.postimg.cc/fTDBV72v/Blizzard.png"},"Creation":{value:3500000,beli:"1.4M",demand:"3/10",image:"https://i.postimg.cc/HLctq6nT/Creation.png"}};
let currentSide='offering';
const selectedOffering=new Set();
const selectedWanting=new Set();
const modal=document.getElementById('tradeModal');
const itemGrid=document.getElementById('itemGrid');
const searchInput=document.getElementById('searchInput');
const offeringTab=document.getElementById('offeringTab');
const requestingTab=document.getElementById('requestingTab');
const confirmPost=document.getElementById('confirmPost');
function itemHTML(name,data){const selected=currentSide==='offering'?selectedOffering.has(name):selectedWanting.has(name);return`<button data-name="${name}" class="relative group flex flex-col items-center p-3 rounded-xl bg-gray-800/50 border border-white/10 hover:border-purple-500/50 transition"><div class="relative"><img src="${data.image}" class="w-20 h-20 object-contain"><div class="tick ${selected?'show':''}"><svg class="w-16 h-16 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M5 13l4 4L19 7"/></svg></div></div><span class="mt-2 text-xs font-medium truncate w-full text-center">${name}</span><span class="text-[10px] text-gray-400">${data.beli} â€¢ ${data.demand}</span></button>`;}
function renderItems(){const term=searchInput.value.toLowerCase();const filtered=Object.entries(fruits).filter(([name])=>name.toLowerCase().includes(term));itemGrid.innerHTML=filtered.map(([name,data])=>itemHTML(name,data)).join('');}
function toggleItem(name){const set=currentSide==='offering'?selectedOffering:selectedWanting;set.has(name)?set.delete(name):set.add(name);renderItems();}
itemGrid.addEventListener('click',e=>{const btn=e.target.closest('button[data-name]');if(btn)toggleItem(btn.dataset.name);});
offeringTab.onclick=()=>{currentSide='offering';offeringTab.classList.replace('bg-gray-700','bg-purple-600');requestingTab.classList.replace('bg-purple-600','bg-gray-700');renderItems();};
requestingTab.onclick=()=>{currentSide='requesting';requestingTab.classList.replace('bg-gray-700','bg-purple-600');offeringTab.classList.replace('bg-purple-600','bg-gray-700');renderItems();};
searchInput.oninput=renderItems;
document.getElementById('postBtn').onclick=()=>{selectedOffering.clear();selectedWanting.clear();currentSide='offering';offeringTab.classList.replace('bg-gray-700','bg-purple-600');requestingTab.classList.replace('bg-purple-600','bg-gray-700');searchInput.value='';renderItems();modal.classList.remove('hidden');document.body.style.overflow='hidden';};
function closeModal(){modal.classList.add('hidden');document.body.style.overflow='';}
document.getElementById('closeModal').onclick=closeModal;
document.getElementById('cancelPost').onclick=closeModal;
confirmPost.onclick=async()=>{if(selectedOffering.size===0||selectedWanting.size===0){alert("Both Offering and Requesting must have at least one item!");return;}
const offering=Array.from(selectedOffering).map(name=>({name,img:fruits[name].image,value:fruits[name].beli,rate:fruits[name].demand}));
const wanting=Array.from(selectedWanting).map(name=>({name,img:fruits[name].image,value:fruits[name].beli,rate:fruits[name].demand}));
const trade={id:Date.now(),offering,wanting,offerValue:offering.reduce((a,i)=>a+(parseFloat(i.value)||0),0)+"M",wantValue:wanting.reduce((a,i)=>a+(parseFloat(i.value)||0),0)+"M",offerRate:"9.5/10",wantRate:"9.5/10"};
try{const res=await fetch(API,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(trade)});if(!res.ok)throw new Error();alert("Trade posted!");closeModal();loadTrades();}catch{alert("Failed to post trade.");}};
function itemHTMLCard(i,color="pink"){const grad=color==="rose"?"from-rose-400/50 to-rose-600/40":"from-pink-400/50 to-pink-600/40";return`<div class="group relative rounded-md border bg-gradient-to-br transition-transform hover:-translate-y-1 hover:z-10 ${grad} p-0.5 border-purple-500/20 h-[120px] w-[90px] sm:h-[150px] sm:w-[120px] shrink-0"><div class="bg-grid-pattern absolute inset-0 opacity-10"></div><div class="relative z-10 flex h-full w-full flex-col"><div class="relative flex flex-1 items-center justify-center p-0.5"><img src="${i.img}" alt="${i.name}" class="h-auto max-h-full w-auto max-w-full object-contain drop-shadow-md"><div class="absolute left-1 top-1"><span class="rounded-md px-1.5 py-0.5 text-[10px] font-bold uppercase bg-purple-600/80 text-white">R</span></div></div><div class="flex flex-col items-center gap-0.5 pb-1"><div class="bg-black/80 backdrop-blur-md rounded-md border border-white/20 p-1.5"><div class="flex items-center gap-2"><div class="flex items-center gap-1"><svg class="h-3 w-3 text-amber-400" viewBox="0 0 512 512" fill="currentColor"><path d="M416 64H257.6L76.5 251.6c-8 8-12.3 18.5-12.5 29-.3 11.3 3.9 22.6 12.5 31.2l123.7 123.6c8 8 20.8 12.5 28.8 12.5s22.8-3.9 31.4-12.5L448 256V96l-32-32zm-30.7 102.7c-21.7 6.1-41.3-10-41.3-30.7 0-17.7 14.3-32 32-32 20.7 0 36.8 19.6 30.7 41.3-2.9 10.3-11.1 18.5-21.4 21.4z"></path></svg><span class="text-xs font-bold text-amber-300">${i.value}</span></div><div class="flex items-center gap-1"><svg class="lucide lucide-trending-up h-3 w-3 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline><polyline points="16 7 22 7 22 13"></polyline></svg><span class="text-xs font-bold text-white">${i.rate}</span></div></div></div></div><div class="absolute inset-x-0 bottom-0.5 flex justify-center"><span class="rounded-full bg-pink-400 h-1.5 w-1.5"></span></div></div></div>`;}
function renderTrade(t){const totalItems=t.offering.length+t.wanting.length;const scrollClass=totalItems>8?'max-h-40 overflow-y-auto':'';const offerHTML=t.offering.map(i=>itemHTMLCard(i,"pink")).join('');const wantHTML=t.wanting.map(i=>itemHTMLCard(i,"rose")).join('');return`<div class="flex flex-row items-center space-x-1 space-y-0 sm:space-y-1.5 animate-in fade-in duration-500 ${scrollClass}"><div class="flex-1 rounded-lg border border-purple-500/10 bg-background/30 p-1.5"><h3 class="mb-1.5 flex items-center gap-1.5 text-sm font-medium text-purple-300"><span class="gradient-text">Offering</span></h3><div class="scrollbar-hide flex space-x-1.5 overflow-x-auto pt-1">${offerHTML}</div></div><div class="flex items-center justify-center"><div class="flex h-8 w-8 items-center justify-center rounded-full bg-purple-500/20 border border-purple-500/30"><svg class="lucide lucide-arrow-right h-4 w-4 text-purple-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg></div></div><div class="flex-1 rounded-lg border border-purple-500/10 bg-background/30 p-1.5"><h3 class="mb-1.5 flex items-center gap-1.5 text-sm font-medium text-purple-300"><span class="gradient-text">Requesting</span></h3><div class="scrollbar-hide flex space-x-1.5 overflow-x-auto pt-1">${wantHTML}</div></div></div>`;}
async function loadTrades(){try{const res=await fetch(API);const data=await res.json();document.getElementById("trades").innerHTML=data.length?data.map(renderTrade).join(""):"<p class='text-center text-gray-500'>No trades yet.</p>";}catch(err){document.getElementById("trades").innerHTML="<p class='text-center text-red-500'>Error loading trades.</p>";}}
loadTrades();renderItems();
</script>
</body>
</html>
